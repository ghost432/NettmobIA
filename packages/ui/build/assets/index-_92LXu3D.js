import{u as Q,a as X,r,b as Z,c as tt,d as et,j as t,M as ot,S as F,T as P,I as at,e as rt,B as x,g as N}from"./index-B5bgjFPS.js";import{I as st}from"./ItemCard-DNyTDo1v.js";import{W as it}from"./workflow_empty-BmvH5JwJ.js";import{C as nt}from"./ConfirmDialog-Dfe34hOz.js";import{F as lt}from"./FlowListTable-DNnT3VGY.js";import{V as ct}from"./ViewHeader-t5dVj9Vk.js";import{E as mt}from"./ErrorBoundary-x4bZaoHs.js";import{D as dt,T as pt}from"./TablePagination-DXVFzOgw.js";import{c as gt}from"./chatflows-CbGmw0-v.js";import{T as ut}from"./ToggleButtonGroup-RXBzXyLf.js";import{I as ft}from"./IconLayoutGrid-Ck6ndNoY.js";import{I as ht}from"./IconPlus-j8jP5X4Z.js";import{S as w}from"./Skeleton-DJP3nnUt.js";import"./Tooltip-CXmeiPEa.js";import"./Edit-CCiZd6ZI.js";import"./Delete-4D-T7tnN.js";import"./SaveChatflowDialog-BSNhDvwI.js";import"./TextField-OmGdqrIf.js";import"./InputLabel-BtU13bbu.js";import"./FormControl-o0rphY-g.js";import"./SpeechToText-CJ66nyGc.js";import"./IconBulb-BQTovKvQ.js";import"./InputAdornment-v58Edx4J.js";import"./IconTrash-CekgWF9B.js";import"./Switch-D5M093wC.js";import"./TooltipWithParser-D26Faoyy.js";import"./index-D--Rb2MU.js";import"./CredentialInputHandler-C4W2GUgN.js";import"./CredentialListDialog-ZkUPpHPz.js";import"./Dropdown-D8Rr64ju.js";import"./Autocomplete-CinIIKT5.js";import"./Close-DT9tpzn1.js";import"./Input-CajAyvOv.js";import"./ListItem-BfStHUI0.js";import"./main-Dw2W3SKo.js";import"./IconArrowsMaximize-BLCViMbK.js";import"./IconAlertTriangle-7YQ2ldQl.js";import"./IconSearch-4bUU90FL.js";import"./ExportAsTemplateDialog-481ESzFy.js";import"./TableSortLabel-jpzZZy1Y.js";import"./StyledFab-DFomU4Vk.js";import"./IconCopy-bbAsun7S.js";import"./Pagination-BU6C4W3P.js";import"./LastPage--XaxDP-k.js";const le=()=>{var L,b,E,I,T,D,k;const j=Q(),i=X(),[m,B]=r.useState(!0),[C,R]=r.useState({}),[p,M]=r.useState(""),{error:S,setError:G}=Z(),a=tt(gt.getAllChatflows),[g,V]=r.useState(localStorage.getItem("flowDisplayStyle")||"card"),[u,O]=r.useState(1),[f,W]=r.useState(dt),[h,_]=r.useState(0),$=(e,o)=>{O(e),W(o),y(e,o)},y=(e,o)=>{const s={page:e||u,limit:o||f};a.request(s)},z=(e,o)=>{o!==null&&(localStorage.setItem("flowDisplayStyle",o),V(o))},H=e=>{M(e.target.value)};function v(e){return(e==null?void 0:e.name.toLowerCase().indexOf(p.toLowerCase()))>-1||e.category&&e.category.toLowerCase().indexOf(p.toLowerCase())>-1||(e==null?void 0:e.id.toLowerCase().indexOf(p.toLowerCase()))>-1}const U=()=>{j("/canvas")},q=e=>{j(`/canvas/${e.id}`)};return r.useEffect(()=>{y(u,f)},[]),r.useEffect(()=>{B(a.loading)},[a.loading]),r.useEffect(()=>{var e,o;if(a.data)try{const s=(e=a.data)==null?void 0:e.data,J=(o=a.data)==null?void 0:o.total;_(J);const d={};for(let n=0;n<s.length;n+=1){const Y=s[n].flowData,c=JSON.parse(Y).nodes||[];d[s[n].id]=[];for(let l=0;l<c.length;l+=1){if(c[l].data.name==="stickyNote"||c[l].data.name==="stickyNoteAgentflow")continue;const A=`${et}/api/v1/node-icon/${c[l].data.name}`;d[s[n].id].some(K=>K.imageSrc===A)||d[s[n].id].push({imageSrc:A,label:c[l].data.label})}}R(d)}catch(s){console.error(s)}},[a.data]),t.jsxs(ot,{children:[S?t.jsx(mt,{error:S}):t.jsxs(F,{flexDirection:"column",sx:{gap:3},children:[t.jsxs(ct,{onSearchChange:H,search:!0,searchPlaceholder:"Search Name or Category",title:"Chatflows",description:"Build single-agent systems, chatbots and simple LLM flows",children:[t.jsxs(ut,{sx:{borderRadius:2,maxHeight:40},value:g,color:"primary",disabled:h===0,exclusive:!0,onChange:z,children:[t.jsx(P,{sx:{borderColor:i.palette.grey[900]+25,borderRadius:2,color:(L=i==null?void 0:i.customization)!=null&&L.isDarkMode?"white":"inherit"},variant:"contained",value:"card",title:"Card View",children:t.jsx(ft,{})}),t.jsx(P,{sx:{borderColor:i.palette.grey[900]+25,borderRadius:2,color:(b=i==null?void 0:i.customization)!=null&&b.isDarkMode?"white":"inherit"},variant:"contained",value:"list",title:"List View",children:t.jsx(at,{})})]}),t.jsx(rt,{permissionId:"chatflows:create",variant:"contained",onClick:U,startIcon:t.jsx(ht,{}),sx:{borderRadius:2,height:40},children:"Add New"})]}),m&&t.jsxs(x,{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:N,children:[t.jsx(w,{variant:"rounded",height:160}),t.jsx(w,{variant:"rounded",height:160}),t.jsx(w,{variant:"rounded",height:160})]}),!m&&h>0&&t.jsxs(t.Fragment,{children:[!g||g==="card"?t.jsx(x,{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:N,children:(I=(E=a.data)==null?void 0:E.data)==null?void 0:I.filter(v).map((e,o)=>t.jsx(st,{onClick:()=>q(e),data:e,images:C[e.id]},o))}):t.jsx(lt,{data:(T=a.data)==null?void 0:T.data,images:C,isLoading:m,filterFunction:v,updateFlowsApi:a,setError:G}),t.jsx(pt,{currentPage:u,limit:f,total:h,onChange:$})]}),!m&&(!((D=a.data)!=null&&D.data)||((k=a.data)==null?void 0:k.data.length)===0)&&t.jsxs(F,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[t.jsx(x,{sx:{p:2,height:"auto"},children:t.jsx("img",{style:{objectFit:"cover",height:"25vh",width:"auto"},src:it,alt:"WorkflowEmptySVG"})}),t.jsx("div",{children:"No Chatflows Yet"})]})]}),t.jsx(nt,{})]})};export{le as default};
