import{t as Be,b as Fe,a as Pe,s as Ne,r as i,c as We,f as qe,j as e,M as He,S as f,B as n,cq as z,g as R,o as a,h as G,a5 as d,E as Ve,ac as $e,e as _e,a9 as Xe,q as v,i as S,L as Je,N as Ke}from"./index-B5bgjFPS.js";import{V as Qe}from"./ViewHeader-t5dVj9Vk.js";import{E as Ye}from"./ErrorBoundary-x4bZaoHs.js";import{B as Ze}from"./BackdropLoader-Ch3nVEPr.js";import{S as T}from"./Switch-D5M093wC.js";import{T as O}from"./TabPanel-C-h4h7GL.js";import{l as X}from"./loginmethod-CpJzrLw7.js";import{A as et,G as tt,a as it}from"./auth0-DQBmZI7E.js";import{G as nt}from"./github-BtlA98as.js";import{I as lt}from"./IconAlertTriangle-7YQ2ldQl.js";import{T as at}from"./Tabs-T-PfpsDr.js";import{I as E}from"./IconCopy-bbAsun7S.js";import"./StyledFab-DFomU4Vk.js";import"./IconSearch-4bUU90FL.js";import"./FormControl-o0rphY-g.js";import"./KeyboardArrowRight-BvTOCIXU.js";const vt=()=>{Be();const{error:J,setError:De}=Fe(),m=Pe(),K=Ne(),b=(...t)=>K(Je(...t)),j=(...t)=>K(Ke(...t)),[D,Q]=i.useState(!1),[U,Y]=i.useState(""),[M,Z]=i.useState(""),[B,ee]=i.useState(""),[te,ke]=i.useState(""),[k,ie]=i.useState(!1),[F,ne]=i.useState(""),[P,le]=i.useState(""),[ae,we]=i.useState(""),[w,se]=i.useState(!1),[N,re]=i.useState(""),[W,oe]=i.useState(""),[ce,Ie]=i.useState(""),[I,de]=i.useState(!1),[q,he]=i.useState(""),[H,ue]=i.useState(""),[V,ge]=i.useState(""),[xe,Ae]=i.useState(""),[pe,h]=i.useState(!1),[$,u]=i.useState([]),g=We(X.getLoginMethods),[x,Le]=i.useState(0),[fe,C]=i.useState(null),ze=!!fe,_=qe(t=>t.auth.user),y=()=>{C(null)},me=t=>{U||t.push("Azure TenantID cannot be left blank!"),M||t.push("Azure ClientID cannot be left blank!"),B||t.push("Azure Client Secret cannot be left blank!")},be=t=>{F||t.push("Google ClientID cannot be left blank!"),P||t.push("Google Client Secret cannot be left blank!")},je=t=>{N||t.push("Github ClientID cannot be left blank!"),W||t.push("Github Client Secret cannot be left blank!")},Ce=t=>{q||t.push("Auth0 Domain cannot be left blank!"),H||t.push("Auth0 ClientID cannot be left blank!"),V||t.push("Auth0 Client Secret cannot be left blank!")},Re=()=>{const t=[];return u([]),D&&me(t),k&&be(t),I&&Ce(t),w&&je(t),t};function ye(){return{organizationId:_.activeOrganizationId,userId:_.id,providers:[{providerLabel:"Microsoft",providerName:"azure",config:{tenantID:U,clientID:M,clientSecret:B},status:D?"enable":"disable"},{providerLabel:"Google",providerName:"google",config:{clientID:F,clientSecret:P},status:k?"enable":"disable"},{providerLabel:"Auth0",providerName:"auth0",config:{domain:q,clientID:H,clientSecret:V},status:I?"enable":"disable"},{providerLabel:"Github",providerName:"github",config:{clientID:N,clientSecret:W},status:w?"enable":"disable"}]}}const Ge=async()=>{const t=Re();if(t.length>0){u(t);return}h(!0);try{const l=await X.updateLoginMethods(ye());u([]),h(!1),l.data&&b({message:"SSO Configuration Updated!",options:{key:new Date().getTime()+Math.random(),variant:"success",action:r=>e.jsx(v,{style:{color:"white"},onClick:()=>j(r),children:e.jsx(S,{})})}})}catch(l){h(!1),u([typeof l.response.data=="object"?l.response.data.message:l.response.data]),b({message:"Failed to update SSO Configuration.",options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:r=>e.jsx(v,{style:{color:"white"},onClick:()=>j(r),children:e.jsx(S,{})})}})}},Te=async t=>{var p;let l=[];switch(t){case"Azure":me(l);break;case"Google":be(l);break;case"Auth0":Ce(l);break;case"Gtihub":je(l);break}if(l.length>0){u(l);return}const r=ye();r.providers=[r.providers[x]],r.providerName=t.toLowerCase(),h(!0);try{const c=await X.testLoginMethod(r);u([]),h(!1),(p=c.data)!=null&&p.message&&b({message:`${A()} SSO Configuration is Valid!`,options:{key:new Date().getTime()+Math.random(),variant:"success",action:o=>e.jsx(v,{style:{color:"white"},onClick:()=>j(o),children:e.jsx(S,{})})}}),c.data.error&&b({message:`${c.data.error}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:o=>e.jsx(v,{style:{color:"white"},onClick:()=>j(o),children:e.jsx(S,{})})}})}catch(c){h(!1),u([typeof c.response.data=="object"?c.response.data.message:c.response.data]),b({message:`Failed to verify ${A()} SSO Configuration.`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:o=>e.jsx(v,{style:{color:"white"},onClick:()=>j(o),children:e.jsx(S,{})})}})}},Oe=t=>{Q(t)},Ee=t=>{ie(t)},Ue=t=>{de(t)},Me=t=>{se(t)},A=()=>{switch(x){case 0:return"Azure";case 1:return"Google";case 2:return"Auth0";case 3:return"Github"}};return i.useEffect(()=>{if(g.data){const t=g.data,l=t.providers.find(s=>s.name==="azure"),r=t.callbacks.find(s=>s.providerName==="azure");r&&ke(r.callbackURL),l&&(Y(l.config.tenantID),Z(l.config.clientID),ee(l.config.clientSecret),Q(l.status==="enable"));const p=t.providers.find(s=>s.name==="google"),c=t.callbacks.find(s=>s.providerName==="google");c&&we(c.callbackURL),p&&(ne(p.config.clientID),le(p.config.clientSecret),ie(p.status==="enable"));const o=t.providers.find(s=>s.name==="auth0"),ve=t.callbacks.find(s=>s.providerName==="auth0");ve&&Ae(ve.callbackURL),o&&(he(o.config.domain),ue(o.config.clientID),ge(o.config.clientSecret),de(o.status==="enable"));const L=t.providers.find(s=>s.name==="github"),Se=t.callbacks.find(s=>s.providerName==="github");Se&&Ie(Se.callbackURL),L&&(re(L.config.clientID),oe(L.config.clientSecret),se(L.status==="enable")),h(!1)}},[g.data]),i.useEffect(()=>{g.error&&(h(!1),De(g.error))},[g.error]),i.useEffect(()=>{h(!0),g.request(_.activeOrganizationId)},[]),e.jsxs(e.Fragment,{children:[e.jsx(He,{children:J?e.jsx(Ye,{error:J}):e.jsxs(f,{flexDirection:"column",sx:{gap:3},children:[e.jsx(Qe,{search:!1,title:"Configure SSO"}),$&&$.length>0&&e.jsxs("div",{style:{position:"relative",display:"flex",flexDirection:"row",alignItems:"center",borderRadius:10,background:"rgb(254,252,191)",padding:10,paddingTop:15,marginTop:10,marginBottom:10},children:[e.jsx(n,{sx:{pl:2},children:e.jsx(lt,{size:25,color:"orange"})}),e.jsx(f,{flexDirection:"column",children:e.jsx("span",{style:{color:"rgb(116,66,16)"},children:e.jsx("ul",{children:$.map((t,l)=>e.jsx("strong",{children:e.jsx("li",{children:t})},l))})})})]}),e.jsxs(at,{value:x,textColor:"primary",onChange:(t,l)=>Le(l),"aria-label":"tabs",children:[e.jsx(z,{iconPosition:"start",icon:e.jsx("img",{alt:"MS_SSO",src:et,width:24,height:24}),sx:{minHeight:"40px",height:"40px",display:"flex",alignItems:"center",mb:1},value:0,label:e.jsxs(e.Fragment,{children:["Microsoft",D&&e.jsx("div",{style:{display:"flex",flexDirection:"row",alignContent:"center",alignItems:"center",background:"#d8f3dc",borderRadius:15,padding:3,paddingLeft:7,paddingRight:7,marginRight:7,marginLeft:7},children:e.jsx("div",{style:{width:15,height:15,borderRadius:"50%",backgroundColor:"#70e000"}})})]})}),e.jsx(z,{iconPosition:"start",icon:e.jsx("img",{alt:"Google_SSO",src:tt,width:24,height:24}),sx:{minHeight:"40px",height:"40px",display:"flex",alignItems:"center",mb:1},value:1,label:e.jsxs(e.Fragment,{children:["Google",k&&e.jsx("div",{style:{display:"flex",flexDirection:"row",alignContent:"center",alignItems:"center",background:"#d8f3dc",borderRadius:15,padding:3,paddingLeft:7,paddingRight:7,marginRight:7,marginLeft:7},children:e.jsx("div",{style:{width:15,height:15,borderRadius:"50%",backgroundColor:"#70e000"}})})]})}),e.jsx(z,{iconPosition:"start",icon:e.jsx("img",{alt:"Auth0_SSO",src:it,width:24,height:24}),sx:{minHeight:"40px",height:"40px",display:"flex",alignItems:"center",mb:1},value:2,label:e.jsxs(e.Fragment,{children:["Auth0",I&&e.jsx("div",{style:{display:"flex",flexDirection:"row",alignContent:"center",alignItems:"center",background:"#d8f3dc",borderRadius:15,padding:3,paddingLeft:7,paddingRight:7,marginRight:7,marginLeft:7},children:e.jsx("div",{style:{width:15,height:15,borderRadius:"50%",backgroundColor:"#70e000"}})})]})}),e.jsx(z,{iconPosition:"start",icon:e.jsx("img",{alt:"Github_SSO",src:nt,width:24,height:24}),sx:{minHeight:"40px",height:"40px",display:"flex",alignItems:"center",mb:1},value:3,label:e.jsxs(e.Fragment,{children:["Github",w&&e.jsx("div",{style:{display:"flex",flexDirection:"row",alignContent:"center",alignItems:"center",background:"#d8f3dc",borderRadius:15,padding:3,paddingLeft:7,paddingRight:7,marginRight:7,marginLeft:7},children:e.jsx("div",{style:{width:15,height:15,borderRadius:"50%",backgroundColor:"#70e000"}})})]})})]}),e.jsx(O,{index:0,value:x,children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:R},children:[e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(a,{style:{verticalAlign:"middle",width:"50%"},children:" Enable SSO Login"}),e.jsx(T,{style:{verticalAlign:"middle",width:"50%"},onChange:Oe,value:D})]}),e.jsx(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:e.jsxs(f,{direction:"row",children:[e.jsx(a,{sx:{p:1,borderRadius:10,backgroundColor:m.palette.primary.light,width:"max-content",height:"max-content"},variant:"h5",children:te}),e.jsx(G,{title:"Copy Callback URL",color:"success",onClick:t=>{navigator.clipboard.writeText(te),C(t.currentTarget),setTimeout(()=>{y()},1500)},children:e.jsx(E,{})})]})}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsx(a,{children:"Tenant ID"}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(d,{id:"email",type:"string",fullWidth:!0,size:"small",placeholder:"Tenant ID",name:"azureTenantID",onChange:t=>Y(t.target.value),value:U})]}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(a,{children:["Client ID",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(d,{id:"name",type:"string",fullWidth:!0,size:"small",placeholder:"Client ID",name:"azureClientID",onChange:t=>Z(t.target.value),value:M})]}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(a,{children:["Client Secret",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(d,{id:"name",type:"password",fullWidth:!0,size:"small",placeholder:"Client Secret",name:"azureClientSecret",onChange:t=>ee(t.target.value),value:B})]})]})}),e.jsx(O,{index:1,value:x,children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:R},children:[e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(a,{style:{verticalAlign:"middle",width:"50%"},children:" Enable SSO Login"}),e.jsx(T,{style:{verticalAlign:"middle",width:"50%"},onChange:Ee,value:k})]}),e.jsx(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:e.jsxs(f,{direction:"row",children:[e.jsx(a,{sx:{p:1,borderRadius:10,backgroundColor:m.palette.primary.light,width:"max-content",height:"max-content"},variant:"h5",children:ae}),e.jsx(G,{title:"Copy Callback URL",color:"success",onClick:t=>{navigator.clipboard.writeText(ae),C(t.currentTarget),setTimeout(()=>{y()},1500)},children:e.jsx(E,{})})]})}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(a,{children:["Client ID",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(d,{id:"name",type:"string",fullWidth:!0,size:"small",placeholder:"Client ID",name:"googleClientID",onChange:t=>ne(t.target.value),value:F})]}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(a,{children:["Client Secret",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(d,{id:"name",type:"password",fullWidth:!0,size:"small",placeholder:"Client Secret",name:"googleClientSecret",onChange:t=>le(t.target.value),value:P})]})]})}),e.jsx(O,{index:2,value:x,children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:R},children:[e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(a,{style:{verticalAlign:"middle",width:"50%"},children:" Enable SSO Login"}),e.jsx(T,{style:{verticalAlign:"middle",width:"50%"},onChange:Ue,value:I})]}),e.jsx(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:e.jsxs(f,{direction:"row",children:[e.jsx(a,{sx:{p:1,borderRadius:10,backgroundColor:m.palette.primary.light,width:"max-content",height:"max-content"},variant:"h5",children:xe}),e.jsx(G,{title:"Copy Callback URL",color:"success",onClick:t=>{navigator.clipboard.writeText(xe),C(t.currentTarget),setTimeout(()=>{y()},1500)},children:e.jsx(E,{})})]})}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsx(a,{children:"Auth0 Domain"}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(d,{id:"email",type:"string",fullWidth:!0,size:"small",placeholder:"Auth0 Domain",name:"auth0Domain",onChange:t=>he(t.target.value),value:q})]}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(a,{children:["Client ID",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(d,{id:"name",type:"string",fullWidth:!0,size:"small",placeholder:"Client ID",name:"auth0ClientID",onChange:t=>ue(t.target.value),value:H})]}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(a,{children:["Client Secret",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(d,{id:"name",type:"password",fullWidth:!0,size:"small",placeholder:"Client Secret",name:"auth0ClientSecret",onChange:t=>ge(t.target.value),value:V})]})]})}),e.jsx(O,{index:3,value:x,children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:R},children:[e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(a,{style:{verticalAlign:"middle",width:"50%"},children:" Enable SSO Login"}),e.jsx(T,{style:{verticalAlign:"middle",width:"50%"},onChange:Me,value:w})]}),e.jsx(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:e.jsxs(f,{direction:"row",children:[e.jsx(a,{sx:{p:1,borderRadius:10,backgroundColor:m.palette.primary.light,width:"max-content",height:"max-content"},variant:"h5",children:ce}),e.jsx(G,{title:"Copy Callback URL",color:"success",onClick:t=>{navigator.clipboard.writeText(ce),C(t.currentTarget),setTimeout(()=>{y()},1500)},children:e.jsx(E,{})})]})}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(a,{children:["Client ID",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(d,{id:"name",type:"string",fullWidth:!0,size:"small",placeholder:"Client ID",name:"githubClientID",onChange:t=>re(t.target.value),value:N})]}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(a,{children:["Client Secret",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(d,{id:"name",type:"password",fullWidth:!0,size:"small",placeholder:"Client Secret",name:"githubClientSecret",onChange:t=>oe(t.target.value),value:W})]})]})}),e.jsx(Ve,{}),e.jsxs(n,{sx:{gridColumn:"span 2 / span 2"},children:[e.jsx($e,{permissionId:"sso:manage",variant:"outlined",style:{marginBottom:10,marginTop:10,marginRight:10},onClick:()=>Te(A()),children:"Test "+A()+" Configuration"}),e.jsx(_e,{permissionId:"sso:manage",style:{marginBottom:10,marginTop:10},variant:"contained",onClick:()=>Ge(),children:"Save"})]})]})}),pe&&e.jsx(Ze,{open:pe}),e.jsx(Xe,{open:ze,anchorEl:fe,onClose:y,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},children:e.jsx(a,{variant:"h6",sx:{pl:1,pr:1,color:"white",background:m.palette.success.dark},children:"Copied!"})})]})};export{vt as default};
