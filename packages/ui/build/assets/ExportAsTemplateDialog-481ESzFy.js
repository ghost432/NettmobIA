import{b4 as i,s as O,r as a,c as F,t as q,v as z,H as E,j as e,D as G,m as H,n as _,B as x,o as u,a5 as h,C as V,p as $,q as y,aa as K,w as R,L as X,i as k,N as Y,P as g}from"./index-B5bgjFPS.js";const J=()=>i.get("/marketplaces/chatflows"),Q=()=>i.get("/marketplaces/tools"),Z=()=>i.get("/marketplaces/templates"),P=()=>i.get("/marketplaces/custom"),ee=l=>i.post("/marketplaces/custom",l),te=l=>i.delete(`/marketplaces/custom/${l}`),se={getAllChatflowsMarketplaces:J,getAllToolsMarketplaces:Q,getAllTemplatesFromMarketplaces:Z,getAllCustomTemplates:P,saveAsCustomTemplate:ee,deleteCustomTemplate:te},ae=({show:l,dialogProps:s,onCancel:p})=>{const I=document.getElementById("portal"),n=O(),[j,d]=a.useState(""),[B,c]=a.useState(""),[A,b]=a.useState(""),[v,S]=a.useState(""),[o,C]=a.useState([]),[f,T]=a.useState(""),r=F(se.saveAsCustomTemplate),D=(...t)=>n(X(...t)),w=(...t)=>n(Y(...t));q(),a.useEffect(()=>(s.chatflow&&(d(s.chatflow.name),s.chatflow.type==="AGENTFLOW"?c("AgentflowV2"):s.chatflow.type==="MULTIAGENT"?c("Agentflow"):s.chatflow.type==="CHATFLOW"&&c("Chatflow")),s.tool&&(d(s.tool.name),b(s.tool.description),c("Tool")),()=>{d(""),b(""),S(""),C([]),c(""),T("")}),[s]),a.useEffect(()=>(n(l?{type:z}:{type:E}),()=>n({type:E})),[l,n]);const N=t=>{T(t.target.value)},W=t=>{t.key==="Enter"&&f.trim()&&(t.preventDefault(),o.includes(f)||(C([...o,f]),T("")))},U=t=>{C(o.filter(m=>m!==t))},M=()=>{if(j.trim()===""){D({message:"Template Name is mandatory!",options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:m=>e.jsx(y,{style:{color:"white"},onClick:()=>w(m),children:e.jsx(k,{})})}});return}const t={name:j,description:A,badge:v?v.toUpperCase():void 0,usecases:o,type:B};s.chatflow&&(t.chatflowId=s.chatflow.id),s.tool&&(t.tool={iconSrc:s.tool.iconSrc,schema:s.tool.schema,func:s.tool.func}),r.request(t)};a.useEffect(()=>{r.data&&(D({message:"Saved as template successfully!",options:{key:new Date().getTime()+Math.random(),variant:"success",persist:!0,action:t=>e.jsx(y,{style:{color:"white"},onClick:()=>w(t),children:e.jsx(k,{})})}}),p())},[r.data]),a.useEffect(()=>{r.error&&(D({message:"Failed to save as template!",options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:t=>e.jsx(y,{style:{color:"white"},onClick:()=>w(t),children:e.jsx(k,{})})}}),p())},[r.error]);const L=l?e.jsxs(G,{onClose:p,open:l,fullWidth:!0,maxWidth:"sm","aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(H,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:s.title||"Export As Template"}),e.jsxs(_,{children:[e.jsx(x,{sx:{pt:2,pb:2},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsxs(u,{sx:{mb:1},children:["Name",e.jsx("span",{style:{color:"red"},children:"Â *"})]}),e.jsx(h,{id:"name",type:"string",fullWidth:!0,value:j,name:"name",size:"small",onChange:t=>{d(t.target.value)}})]})}),e.jsx(x,{sx:{pt:2,pb:2},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(u,{sx:{mb:1},children:"Description"}),e.jsx(h,{id:"description",type:"string",fullWidth:!0,multiline:!0,rows:2,value:A,name:"description",size:"small",onChange:t=>{b(t.target.value)}})]})}),e.jsx(x,{sx:{pt:2,pb:2},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(u,{sx:{mb:1},children:"Badge"}),e.jsx(h,{id:"badge",type:"string",fullWidth:!0,value:v,name:"badge",size:"small",onChange:t=>{S(t.target.value)}})]})}),e.jsx(x,{sx:{pt:2,pb:2},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(u,{sx:{mb:1},children:"Usecases"}),o.length>0&&e.jsx("div",{style:{marginBottom:10},children:o.map((t,m)=>e.jsx(V,{label:t,onDelete:()=>U(t),style:{marginRight:5,marginBottom:5}},m))}),e.jsx(h,{fullWidth:!0,value:f,onChange:N,onKeyDown:W,variant:"outlined"}),e.jsx(u,{variant:"body2",sx:{fontStyle:"italic",mt:1},color:"text.secondary",children:"Type a usecase and press enter to add it to the list. You can add as many items as you want."})]})})]}),e.jsxs($,{children:[e.jsx(y,{onClick:p,children:s.cancelButtonName||"Cancel"}),e.jsx(K,{disabled:s.disabled,variant:"contained",onClick:M,children:s.confirmButtonName||"Save Template"})]})]}):null;return R.createPortal(L,I)};ae.propTypes={show:g.bool,dialogProps:g.object,onCancel:g.func,onConfirm:g.func};export{ae as E,se as m};
