import{u as te,a as oe,f as re,r,b as se,c as ae,A as ie,d as ne,j as e,M as ce,S as V,T as x,C as le,I as de,e as me,B as v,h as ge,i as pe,g as fe}from"./index-B5bgjFPS.js";import{I as ue}from"./ItemCard-DNyTDo1v.js";import{C as he}from"./ConfirmDialog-Dfe34hOz.js";import{F as xe}from"./FlowListTable-DNnT3VGY.js";import{V as ve}from"./ViewHeader-t5dVj9Vk.js";import{E as we}from"./ErrorBoundary-x4bZaoHs.js";import{D as je,T as Ce}from"./TablePagination-DXVFzOgw.js";import{c as Se}from"./chatflows-CbGmw0-v.js";import{T as F}from"./ToggleButtonGroup-RXBzXyLf.js";import{I as ye}from"./IconLayoutGrid-Ck6ndNoY.js";import{I as be}from"./IconPlus-j8jP5X4Z.js";import{I as Ie}from"./IconAlertTriangle-7YQ2ldQl.js";import"./Tooltip-CXmeiPEa.js";import"./Edit-CCiZd6ZI.js";import"./Delete-4D-T7tnN.js";import"./SaveChatflowDialog-BSNhDvwI.js";import"./TextField-OmGdqrIf.js";import"./InputLabel-BtU13bbu.js";import"./FormControl-o0rphY-g.js";import"./SpeechToText-CJ66nyGc.js";import"./IconBulb-BQTovKvQ.js";import"./InputAdornment-v58Edx4J.js";import"./IconTrash-CekgWF9B.js";import"./Switch-D5M093wC.js";import"./TooltipWithParser-D26Faoyy.js";import"./index-D--Rb2MU.js";import"./CredentialInputHandler-C4W2GUgN.js";import"./CredentialListDialog-ZkUPpHPz.js";import"./Dropdown-D8Rr64ju.js";import"./Autocomplete-CinIIKT5.js";import"./Close-DT9tpzn1.js";import"./Input-CajAyvOv.js";import"./ListItem-BfStHUI0.js";import"./main-Dw2W3SKo.js";import"./IconArrowsMaximize-BLCViMbK.js";import"./IconSearch-4bUU90FL.js";import"./ExportAsTemplateDialog-481ESzFy.js";import"./TableSortLabel-jpzZZy1Y.js";import"./Skeleton-DJP3nnUt.js";import"./StyledFab-DFomU4Vk.js";import"./IconCopy-bbAsun7S.js";import"./Pagination-BU6C4W3P.js";import"./LastPage--XaxDP-k.js";const Ae="/assets/agents_empty-CPmzgTXa.svg",xt=()=>{var L,k;const g=te(),p=oe(),i=re(t=>t.customization),[w,M]=r.useState(!0),[I,R]=r.useState({}),[A,P]=r.useState({}),[j,G]=r.useState(""),{error:D,setError:E}=se(),s=ae(Se.getAllAgentflows),[C,O]=r.useState(localStorage.getItem("flowDisplayStyle")||"card"),[l,z]=r.useState(localStorage.getItem("agentFlowVersion")||"v2"),[B,W]=r.useState(!0),[S,_]=r.useState(1),[f,$]=r.useState(je),[u,H]=r.useState(0),U=(t,o)=>{_(t),$(o),y(t,o,l)},y=(t,o,a)=>{const d={page:t||S,limit:o||f};s.request(a==="v2"?"AGENTFLOW":"MULTIAGENT",d)},X=(t,o)=>{o!==null&&(localStorage.setItem("flowDisplayStyle",o),O(o))},q=(t,o)=>{o!==null&&(localStorage.setItem("agentFlowVersion",o),z(o),y(1,f,o))},J=t=>{G(t.target.value)};function T(t){return t.name.toLowerCase().indexOf(j.toLowerCase())>-1||t.category&&t.category.toLowerCase().indexOf(j.toLowerCase())>-1||t.id.toLowerCase().indexOf(j.toLowerCase())>-1}const Y=()=>{g(l==="v2"?"/v2/agentcanvas":"/agentcanvas")},K=t=>{t.type==="AGENTFLOW"?g(`/v2/agentcanvas/${t.id}`):g(`/agentcanvas/${t.id}`)},Q=()=>{W(!1)};return r.useEffect(()=>{y(S,f,l)},[]),r.useEffect(()=>{s.error&&E(s.error)},[s.error]),r.useEffect(()=>{M(s.loading)},[s.loading]),r.useEffect(()=>{var t,o;if(s.data)try{const a=(t=s.data)==null?void 0:t.data;H((o=s.data)==null?void 0:o.total);const d={},b={};for(let n=0;n<a.length;n+=1){const Z=a[n].flowData,m=JSON.parse(Z).nodes||[];d[a[n].id]=[],b[a[n].id]=[];for(let c=0;c<m.length;c+=1){if(m[c].data.name==="stickyNote"||m[c].data.name==="stickyNoteAgentflow")continue;const N=ie.find(h=>h.name===m[c].data.name);if(N)b[a[n].id].push(N);else{const h=`${ne}/api/v1/node-icon/${m[c].data.name}`;d[a[n].id].some(ee=>ee.imageSrc===h)||d[a[n].id].push({imageSrc:h,label:m[c].data.label})}}}R(d),P(b)}catch(a){console.error(a)}},[s.data]),e.jsxs(ce,{children:[D?e.jsx(we,{error:D}):e.jsxs(V,{flexDirection:"column",sx:{gap:3},children:[e.jsxs(ve,{onSearchChange:J,search:!0,searchPlaceholder:"Search Name or Category",title:"Agentflows",description:"Multi-agent systems, workflow orchestration",children:[e.jsxs(F,{sx:{borderRadius:2,maxHeight:40},value:l,color:"primary",exclusive:!0,onChange:q,children:[e.jsxs(x,{sx:{borderColor:p.palette.grey[900]+25,borderRadius:2,color:i.isDarkMode?"white":"inherit"},variant:"contained",value:"v2",title:"V2",children:[e.jsx(le,{sx:{mr:1},label:"NEW",size:"small",color:"primary"}),"V2"]}),e.jsx(x,{sx:{borderColor:p.palette.grey[900]+25,borderRadius:2,color:i.isDarkMode?"white":"inherit"},variant:"contained",value:"v1",title:"V1",children:"V1"})]}),e.jsxs(F,{sx:{borderRadius:2,maxHeight:40},value:C,disabled:u===0,color:"primary",exclusive:!0,onChange:X,children:[e.jsx(x,{sx:{borderColor:p.palette.grey[900]+25,borderRadius:2,color:i.isDarkMode?"white":"inherit"},variant:"contained",value:"card",title:"Card View",children:e.jsx(ye,{})}),e.jsx(x,{sx:{borderColor:p.palette.grey[900]+25,borderRadius:2,color:i.isDarkMode?"white":"inherit"},variant:"contained",value:"list",title:"List View",children:e.jsx(de,{})})]}),e.jsx(me,{permissionId:"agentflows:create",variant:"contained",onClick:Y,startIcon:e.jsx(be,{}),sx:{borderRadius:2,height:40},children:"Add New"})]}),l==="v1"&&B&&e.jsxs(v,{sx:{display:"flex",alignItems:"center",padding:2,background:i.isDarkMode?"linear-gradient(135deg,rgba(165, 128, 6, 0.31) 0%, #ffcc802f 100%)":"linear-gradient(135deg, #fff8e17a 0%, #ffcc804a 100%)",color:i.isDarkMode?"white":"#333333",fontWeight:400,borderRadius:2,gap:1.5},children:[e.jsx(Ie,{size:20,style:{color:i.isDarkMode?"#ffcc80":"#f57c00",flexShrink:0}}),e.jsxs(v,{sx:{flex:1},children:[e.jsx("strong",{children:"V1 Agentflows are deprecated."})," We recommend migrating to V2 for improved performance and continued support."]}),e.jsx(ge,{"aria-label":"dismiss",size:"small",onClick:Q,sx:{color:i.isDarkMode?"#ffcc80":"#f57c00","&:hover":{backgroundColor:"rgba(255, 204, 128, 0.1)"}},children:e.jsx(pe,{size:16})})]}),!w&&u>0&&e.jsxs(e.Fragment,{children:[!C||C==="card"?e.jsx(v,{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:fe,children:(L=s.data)==null?void 0:L.data.filter(T).map((t,o)=>e.jsx(ue,{onClick:()=>K(t),data:t,images:I[t.id],icons:A[t.id]},o))}):e.jsx(xe,{isAgentCanvas:!0,isAgentflowV2:l==="v2",data:(k=s.data)==null?void 0:k.data,images:I,icons:A,isLoading:w,filterFunction:T,updateFlowsApi:s,setError:E}),e.jsx(Ce,{currentPage:S,limit:f,total:u,onChange:U})]}),!w&&u===0&&e.jsxs(V,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[e.jsx(v,{sx:{p:2,height:"auto"},children:e.jsx("img",{style:{objectFit:"cover",height:"12vh",width:"auto"},src:Ae,alt:"AgentsEmptySVG"})}),e.jsx("div",{children:"No Agents Yet"})]})]}),e.jsx(he,{})]})};export{xt as default};
