import{a as L,s as B,f as H,r as s,c as O,v as V,H as C,j as e,D as G,n as R,o as W,q as E,bN as _,p as w,aa as F,w as q,P as r}from"./index-B5bgjFPS.js";import{C as D}from"./CodeEditor-BbQJOBPh.js";import{n as z}from"./nodes-Qb-8otVq.js";import{L as J}from"./LoadingButton-CJHvS9bV.js";const M=({show:c,dialogProps:a,onCancel:S,onInputHintDialogClicked:k,onConfirm:A})=>{const N=document.getElementById("portal"),p=L(),d=B(),g=H(o=>o.customization),[f,h]=s.useState(""),[n,y]=s.useState(null),[i,x]=s.useState("json"),[T,m]=s.useState(!1),[u,l]=s.useState(""),t=O(z.executeCustomFunctionNode);s.useEffect(()=>(a.value&&h(a.value),a.inputParam&&(y(a.inputParam),a.inputParam.type==="code"&&x("js")),a.languageType&&x(a.languageType),()=>{h(""),m(!1),y(null),x("json"),l("")}),[a]),s.useEffect(()=>(d(c?{type:V}:{type:C}),()=>d({type:C})),[c,d]),s.useEffect(()=>{m(t.loading)},[t.loading]),s.useEffect(()=>{t.data&&(typeof t.data=="object"?l(JSON.stringify(t.data,null,2)):l(t.data))},[t.data]),s.useEffect(()=>{var o,b,j,v;t.error&&(typeof t.error=="object"&&((b=(o=t.error)==null?void 0:o.response)!=null&&b.data)?l((v=(j=t.error)==null?void 0:j.response)==null?void 0:v.data):typeof t.error=="string"&&l(t.error))},[t.error]);const I=c?e.jsxs(G,{open:c,fullWidth:!0,maxWidth:"md","aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsxs(R,{children:[e.jsx("div",{style:{display:"flex",flexDirection:"row"},children:n&&(n.type==="string"||n.type==="code")&&e.jsxs("div",{style:{flex:70},children:[e.jsxs("div",{style:{marginBottom:"10px",display:"flex",flexDirection:"row"},children:[e.jsx(W,{variant:"h4",children:n.label}),e.jsx("div",{style:{flex:1}}),n.hint&&e.jsx(E,{sx:{p:0,px:2},color:"secondary",variant:"text",onClick:()=>{k(n.hint)},children:n.hint.label})]}),e.jsx(_,{style:{border:"1px solid",borderColor:p.palette.grey[500],borderRadius:"12px",height:"100%",maxHeight:i==="js"?"calc(100vh - 250px)":"calc(100vh - 220px)",overflowX:"hidden",backgroundColor:"white"},children:e.jsx(D,{disabled:a.disabled,value:f,height:i==="js"?"calc(100vh - 250px)":"calc(100vh - 220px)",theme:g.isDarkMode?"dark":"light",lang:i,placeholder:n.placeholder,basicSetup:i!=="js"?{lineNumbers:!1,foldGutter:!1,autocompletion:!1,highlightActiveLine:!1}:{},onValueChange:o=>h(o)})})]})}),i==="js"&&!n.hideCodeExecute&&e.jsx(J,{sx:{mt:2,"&:hover":{backgroundColor:p.palette.secondary.main,backgroundImage:"linear-gradient(rgb(0 0 0/10%) 0 0)"},"&:disabled":{backgroundColor:p.palette.secondary.main,backgroundImage:"linear-gradient(rgb(0 0 0/50%) 0 0)"}},loading:T,variant:"contained",fullWidth:!0,color:"secondary",onClick:()=>{m(!0),t.request({javascriptFunction:f})},children:"Execute"}),u&&e.jsx("div",{style:{marginTop:"15px"},children:e.jsx(D,{disabled:!0,value:typeof u=="object"?JSON.stringify(u,null,2):u,height:"max-content",theme:g.isDarkMode?"dark":"light",lang:"js",basicSetup:{lineNumbers:!1,foldGutter:!1,autocompletion:!1,highlightActiveLine:!1}})})]}),e.jsxs(w,{children:[e.jsx(E,{onClick:S,children:a.cancelButtonName}),e.jsx(F,{disabled:a.disabled,variant:"contained",onClick:()=>A(f,n.name),children:a.confirmButtonName})]})]}):null;return q.createPortal(I,N)};M.propTypes={show:r.bool,dialogProps:r.object,onCancel:r.func,onConfirm:r.func,onInputHintDialogClicked:r.func};export{M as E};
