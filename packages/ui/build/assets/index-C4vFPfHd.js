import{a as oe,f as ne,s as le,t as de,b as ce,r as a,c as T,at as me,j as e,M as he,S as A,e as pe,B as j,Q as xe,R as je,U as Ce,V as ge,W as Y,y as $,X as ue,d as fe,Z as B,a0 as C,_ as Se,$ as M,q as L,i as R,L as ye,N as De}from"./index-B5bgjFPS.js";import{k as be,C as we,A as ke,c as g}from"./CredentialListDialog-ZkUPpHPz.js";import{u as Pe,C as ve}from"./ConfirmDialog-Dfe34hOz.js";import{V as Ee}from"./ViewHeader-t5dVj9Vk.js";import{E as Ie}from"./ErrorBoundary-x4bZaoHs.js";import{S as Ne}from"./ShareWithWorkspaceDialog-C_XUNE5d.js";import{I as Te}from"./IconPlus-j8jP5X4Z.js";import{S as r}from"./Skeleton-DJP3nnUt.js";import{I as Ae}from"./IconShare-D3uBFiqr.js";import{I as Be}from"./IconSearch-4bUU90FL.js";import{I as Me}from"./IconTrash-CekgWF9B.js";import"./TooltipWithParser-D26Faoyy.js";import"./index-D--Rb2MU.js";import"./Tooltip-CXmeiPEa.js";import"./Dropdown-D8Rr64ju.js";import"./FormControl-o0rphY-g.js";import"./Autocomplete-CinIIKT5.js";import"./Close-DT9tpzn1.js";import"./TextField-OmGdqrIf.js";import"./InputLabel-BtU13bbu.js";import"./Input-CajAyvOv.js";import"./ListItem-BfStHUI0.js";import"./Switch-D5M093wC.js";import"./main-Dw2W3SKo.js";import"./IconArrowsMaximize-BLCViMbK.js";import"./IconAlertTriangle-7YQ2ldQl.js";import"./InputAdornment-v58Edx4J.js";import"./StyledFab-DFomU4Vk.js";import"./IconCopy-bbAsun7S.js";import"./Grid-DGDGmzGP.js";import"./toPropertyKey-C9c9JG92.js";import"./createStyled-DlEbU-rO.js";import"./KeyboardArrowRight-BvTOCIXU.js";import"./LastPage--XaxDP-k.js";const Le="/assets/credential_empty-BUL4Jfyn.svg",s=$(Se)(({theme:i})=>({borderColor:i.palette.grey[900]+25,padding:"6px 16px",[`&.${M.head}`]:{color:i.palette.grey[900]},[`&.${M.body}`]:{fontSize:14,height:64}})),u=$(Y)(()=>({"&:last-child td, &:last-child th":{border:0}})),Ct=()=>{const i=oe(),f=ne(t=>t.customization),d=le();de();const{error:S,setError:y}=ce(),D=(...t)=>d(ye(...t)),b=(...t)=>d(De(...t)),[w,F]=a.useState(!0),[q,c]=a.useState(!1),[H,V]=a.useState({}),[k,m]=a.useState(!1),[U,P]=a.useState({}),[v,W]=a.useState([]),[_,z]=a.useState([]),[E,I]=a.useState(!1),[G,O]=a.useState({}),{confirm:X}=Pe(),o=T(g.getAllCredentials),l=T(g.getAllComponentsCredentials),[J,Q]=a.useState(""),Z=t=>{Q(t.target.value)};function K(t){return t.credentialName.toLowerCase().indexOf(J.toLowerCase())>-1}const ee=()=>{V({title:"Add New Credential",componentsCredentials:_}),c(!0)},te=t=>{P({type:"ADD",cancelButtonName:"Cancel",confirmButtonName:"Add",credentialComponent:t}),m(!0)},se=t=>{P({type:"EDIT",cancelButtonName:"Cancel",confirmButtonName:"Save",data:t}),m(!0)},ae=t=>{const n={type:"EDIT",cancelButtonName:"Cancel",confirmButtonName:"Share",data:{id:t.id,name:t.name,title:"Share Credential",itemType:"credential"}};O(n),I(!0)},re=async t=>{const n={title:"Delete",description:`Delete credential ${t.name}?`,confirmButtonName:"Delete",cancelButtonName:"Cancel"};if(await X(n))try{(await g.deleteCredential(t.id)).data&&(D({message:"Credential deleted",options:{key:new Date().getTime()+Math.random(),variant:"success",action:x=>e.jsx(L,{style:{color:"white"},onClick:()=>b(x),children:e.jsx(R,{})})}}),N())}catch(p){D({message:`Failed to delete Credential: ${typeof p.response.data=="object"?p.response.data.message:p.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:x=>e.jsx(L,{style:{color:"white"},onClick:()=>b(x),children:e.jsx(R,{})})}})}},ie=t=>{c(!1),te(t)},N=()=>{c(!1),m(!1),o.request()};return a.useEffect(()=>{o.request(),l.request()},[]),a.useEffect(()=>{F(o.loading)},[o.loading]),a.useEffect(()=>{o.data&&W(o.data)},[o.data]),a.useEffect(()=>{l.data&&(z(l.data),d({type:me,componentsCredentials:l.data}))},[l.data,d]),e.jsxs(e.Fragment,{children:[e.jsx(he,{children:S?e.jsx(Ie,{error:S}):e.jsxs(A,{flexDirection:"column",sx:{gap:3},children:[e.jsx(Ee,{onSearchChange:Z,search:!0,searchPlaceholder:"Search Credentials",title:"Credentials",description:"API keys, tokens, and secrets for 3rd party integrations",children:e.jsx(pe,{permissionId:"credentials:create",variant:"contained",sx:{borderRadius:2,height:"100%"},onClick:ee,startIcon:e.jsx(Te,{}),children:"Add Credential"})}),!w&&v.length<=0?e.jsxs(A,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[e.jsx(j,{sx:{p:2,height:"auto"},children:e.jsx("img",{style:{objectFit:"cover",height:"16vh",width:"auto"},src:Le,alt:"CredentialEmptySVG"})}),e.jsx("div",{children:"No Credentials Yet"})]}):e.jsx(xe,{sx:{border:1,borderColor:i.palette.grey[900]+25,borderRadius:2},component:je,children:e.jsxs(Ce,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(ge,{sx:{backgroundColor:f.isDarkMode?i.palette.common.black:i.palette.grey[100],height:56},children:e.jsxs(Y,{children:[e.jsx(s,{children:"Name"}),e.jsx(s,{children:"Last Updated"}),e.jsx(s,{children:"Created"}),e.jsx(s,{style:{width:"5%"},children:" "}),e.jsx(s,{style:{width:"5%"},children:" "}),e.jsx(s,{style:{width:"5%"},children:" "})]})}),e.jsx(ue,{children:w?e.jsxs(e.Fragment,{children:[e.jsxs(u,{children:[e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})})]}),e.jsxs(u,{children:[e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})})]})]}):e.jsx(e.Fragment,{children:v.filter(K).map((t,n)=>e.jsxs(u,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(s,{scope:"row",children:e.jsxs(j,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[e.jsx(j,{sx:{width:35,height:35,borderRadius:"50%",backgroundColor:f.isDarkMode?i.palette.common.white:i.palette.grey[300]+75},children:e.jsx("img",{style:{width:"100%",height:"100%",padding:5,objectFit:"contain"},alt:t.credentialName,src:`${fe}/api/v1/components-credentials-icon/${t.credentialName}`,onError:h=>{h.target.onerror=null,h.target.style.padding="5px",h.target.src=be}})}),t.name]})}),e.jsx(s,{children:B(t.updatedDate).format("MMMM Do, YYYY HH:mm:ss")}),e.jsx(s,{children:B(t.createdDate).format("MMMM Do, YYYY HH:mm:ss")}),!t.shared&&e.jsxs(e.Fragment,{children:[e.jsx(s,{children:e.jsx(C,{permissionId:"credentials:share",display:"feat:workspaces",title:"Share",color:"primary",onClick:()=>ae(t),children:e.jsx(Ae,{})})}),e.jsx(s,{children:e.jsx(C,{permissionId:"credentials:create,credentials:update",title:"Edit",color:"primary",onClick:()=>se(t),children:e.jsx(Be,{})})}),e.jsx(s,{children:e.jsx(C,{permissionId:"credentials:delete",title:"Delete",color:"error",onClick:()=>re(t),children:e.jsx(Me,{})})})]}),t.shared&&e.jsx(e.Fragment,{children:e.jsx(s,{colSpan:"3",children:"Shared Credential"})})]},n))})})]})})]})}),e.jsx(we,{show:q,dialogProps:H,onCancel:()=>c(!1),onCredentialSelected:ie}),k&&e.jsx(ke,{show:k,dialogProps:U,onCancel:()=>m(!1),onConfirm:N,setError:y}),E&&e.jsx(Ne,{show:E,dialogProps:G,onCancel:()=>I(!1),setError:y}),e.jsx(ve,{})]})};export{Ct as default};
