import{s as M,t as P,r as i,v as T,H as w,j as s,D as V,m as $,ai as G,n as J,B as g,o as R,a5 as q,p as F,q as C,aa as H,w as W,i as b,L as _,N as U,P as h,u as z,c as X,M as Y,S as k,e as K,g as I,d as Q}from"./index-B5bgjFPS.js";import{V as Z}from"./ViewHeader-t5dVj9Vk.js";import{I as ss}from"./ItemCard-DNyTDo1v.js";import{A as ts}from"./assistant_empty-BAOmXGQM.js";import{C as es}from"./ConfirmDialog-Dfe34hOz.js";import{a as E}from"./assistants-DZYxhrU8.js";import{v as as}from"./v4-CtRu48qb.js";import{E as is}from"./ErrorBoundary-x4bZaoHs.js";import{I as os}from"./IconPlus-j8jP5X4Z.js";import{S}from"./Skeleton-DJP3nnUt.js";import"./StyledFab-DFomU4Vk.js";import"./IconSearch-4bUU90FL.js";import"./Tooltip-CXmeiPEa.js";import"./IconCopy-bbAsun7S.js";const B=({show:n,dialogProps:e,onCancel:c,onConfirm:x})=>{const u=document.getElementById("portal"),o=M();P();const p=(...a)=>o(_(...a)),l=(...a)=>o(U(...a)),[m,f]=i.useState("");i.useEffect(()=>(o(n?{type:T}:{type:w}),()=>o({type:w})),[n,o]);const j=async()=>{try{const a={details:JSON.stringify({name:m}),credential:as(),type:"CUSTOM"},d=await E.createNewAssistant(a);d.data&&(p({message:"New Custom Assistant created.",options:{key:new Date().getTime()+Math.random(),variant:"success",action:A=>s.jsx(C,{style:{color:"white"},onClick:()=>l(A),children:s.jsx(b,{})})}}),x(d.data.id))}catch(a){p({message:`Failed to add new Custom Assistant: ${typeof a.response.data=="object"?a.response.data.message:a.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:d=>s.jsx(C,{style:{color:"white"},onClick:()=>l(d),children:s.jsx(b,{})})}}),c()}},y=n?s.jsxs(V,{fullWidth:!0,maxWidth:"sm",open:n,onClose:c,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[s.jsx($,{style:{fontSize:"1rem"},id:"alert-dialog-title",children:s.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[s.jsx(G,{style:{marginRight:"10px"}}),e.title]})}),s.jsx(J,{children:s.jsxs(g,{sx:{p:2},children:[s.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[s.jsxs(R,{children:["Name",s.jsx("span",{style:{color:"red"},children:"Â *"})]}),s.jsx("div",{style:{flexGrow:1}})]}),s.jsx(q,{size:"small",sx:{mt:1},type:"string",fullWidth:!0,onChange:a=>f(a.target.value),value:m??""},"customAssistantName")]})}),s.jsxs(F,{children:[s.jsx(C,{onClick:()=>c(),children:"Cancel"}),s.jsx(H,{disabled:!m,variant:"contained",onClick:()=>j(),children:e.confirmButtonName})]}),s.jsx(es,{})]}):null;return W.createPortal(y,u)};B.propTypes={show:h.bool,dialogProps:h.object,onCancel:h.func,onConfirm:h.func};const As=()=>{var D;const n=z(),e=X(E.getAllAssistants),[c,x]=i.useState(!0),[u,o]=i.useState(null),[p,l]=i.useState(!1),[m,f]=i.useState({}),[j,y]=i.useState(""),a=t=>{y(t.target.value)},d=()=>{f({title:"Add New Custom Assistant",type:"ADD",cancelButtonName:"Cancel",confirmButtonName:"Add"}),l(!0)},A=t=>{l(!1),n(`/assistants/custom/${t}`)};function O(t){const r=JSON.parse(t.details);return r&&r.name&&r.name.toLowerCase().indexOf(j.toLowerCase())>-1}const L=t=>{const r=[];return t&&t.chatModel&&t.chatModel.name&&r.push({imageSrc:`${Q}/api/v1/node-icon/${t.chatModel.name}`}),r};return i.useEffect(()=>{e.request("CUSTOM")},[]),i.useEffect(()=>{x(e.loading)},[e.loading]),i.useEffect(()=>{e.error&&o(e.error)},[e.error]),s.jsxs(s.Fragment,{children:[s.jsx(Y,{children:u?s.jsx(is,{error:u}):s.jsxs(k,{flexDirection:"column",sx:{gap:3},children:[s.jsx(Z,{isBackButton:!0,onSearchChange:a,search:!0,searchPlaceholder:"Search Assistants",title:"Custom Assistant",description:"Create custom assistants with your choice of LLMs",onBack:()=>n(-1),children:s.jsx(K,{permissionId:"assistants:create",variant:"contained",sx:{borderRadius:2,height:40},onClick:d,startIcon:s.jsx(os,{}),children:"Add"})}),c?s.jsxs(g,{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:I,children:[s.jsx(S,{variant:"rounded",height:160}),s.jsx(S,{variant:"rounded",height:160}),s.jsx(S,{variant:"rounded",height:160})]}):s.jsx(g,{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:I,children:e.data&&((D=e.data)==null?void 0:D.filter(O).map((t,r)=>{var v,N;return s.jsx(ss,{data:{name:(v=JSON.parse(t.details))==null?void 0:v.name,description:(N=JSON.parse(t.details))==null?void 0:N.instruction},images:L(JSON.parse(t.details)),onClick:()=>n("/assistants/custom/"+t.id)},r)}))}),!c&&(!e.data||e.data.length===0)&&s.jsxs(k,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[s.jsx(g,{sx:{p:2,height:"auto"},children:s.jsx("img",{style:{objectFit:"cover",height:"20vh",width:"auto"},src:ts,alt:"AssistantEmptySVG"})}),s.jsx("div",{children:"No Custom Assistants Added Yet"})]})]})}),s.jsx(B,{show:p,dialogProps:m,onCancel:()=>l(!1),onConfirm:A,setError:o})]})};export{As as default};
