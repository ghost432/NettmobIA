import{af as Ve,s as Q,t as Y,r as s,v as ue,H as W,j as e,D as pe,m as me,b5 as he,n as xe,B as G,o as L,a5 as re,p as ge,q as f,e as q,w as De,i as E,L as J,N as K,P as N,aa as qe,k as We,l as Ge,a as Le,f as He,b as Xe,c as ie,O as Qe,M as Ye,S as le,ac as Je,az as Ke,Q as Ze,R as et,U as tt,V as at,W as st,a3 as ce,X as ot}from"./index-B5bgjFPS.js";import{a as p,S as X}from"./TableStyles-gXDYNr-F.js";import{C as Z,u as nt}from"./ConfirmDialog-Dfe34hOz.js";import{d as F}from"./dataset-DMHJH1v5.js";import{S as rt}from"./Switch-D5M093wC.js";import{F as it,I as lt}from"./File-km8sc6Tq.js";import{T as ct}from"./TooltipWithParser-D26Faoyy.js";import{E as dt}from"./ErrorBoundary-x4bZaoHs.js";import{V as ut}from"./ViewHeader-t5dVj9Vk.js";import{A as pt}from"./AddEditDatasetDialog-ILwo7kNc.js";import{D as mt,T as ht}from"./TablePagination-DXVFzOgw.js";import{e as xt}from"./empty_datasets-sHG3vrEn.js";import{I as de}from"./IconPlus-j8jP5X4Z.js";import{I as gt}from"./IconTrash-CekgWF9B.js";import{S as T}from"./Skeleton-DJP3nnUt.js";import"./FormControl-o0rphY-g.js";import"./index-D--Rb2MU.js";import"./Tooltip-CXmeiPEa.js";import"./IconCopy-bbAsun7S.js";import"./StyledFab-DFomU4Vk.js";import"./IconSearch-4bUU90FL.js";import"./Pagination-BU6C4W3P.js";import"./LastPage--XaxDP-k.js";/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=[["path",{d:"M17 3l0 18",key:"svg-0"}],["path",{d:"M10 18l-3 3l-3 -3",key:"svg-1"}],["path",{d:"M7 21l0 -18",key:"svg-2"}],["path",{d:"M20 6l-3 -3l-3 3",key:"svg-3"}]],jt=Ve("outline","arrows-down-up","ArrowsDownUp",Dt),je=({show:m,dialogProps:i,onCancel:h,onConfirm:A})=>{const _=document.getElementById("portal"),l=Q();Y();const D=(...n)=>l(J(...n)),x=(...n)=>l(K(...n)),[M,w]=s.useState(""),[B,y]=s.useState(""),[v,C]=s.useState(""),[a,S]=s.useState(""),[P,b]=s.useState("ADD"),[c,j]=s.useState({});s.useEffect(()=>(i.type==="EDIT"&&i.data?(w(i.data.datasetId),y(i.data.datasetName),b("EDIT"),j(i.data),C(i.data.input),S(i.data.output)):i.type==="ADD"&&(w(i.data.datasetId),y(i.data.datasetName),b("ADD"),j({})),()=>{C(""),S(""),b("ADD"),j({})}),[i]),s.useEffect(()=>(l(m?{type:ue}:{type:W}),()=>l({type:W})),[m,l]);const d=async()=>{try{const n={datasetId:M,input:v,output:a},g=await F.createDatasetRow(n);g.data&&(D({message:"New Row added for the given Dataset",options:{key:new Date().getTime()+Math.random(),variant:"success",action:k=>e.jsx(f,{style:{color:"white"},onClick:()=>x(k),children:e.jsx(E,{})})}}),A(g.data.id))}catch(n){D({message:`Failed to add new row in the Dataset: ${typeof n.response.data=="object"?n.response.data.message:n.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:g=>e.jsx(f,{style:{color:"white"},onClick:()=>x(g),children:e.jsx(E,{})})}}),h()}},I=async()=>{try{const n={input:v,output:a},g=await F.updateDatasetRow(c.id,n);g.data&&(D({message:"Dataset Row saved",options:{key:new Date().getTime()+Math.random(),variant:"success",action:k=>e.jsx(f,{style:{color:"white"},onClick:()=>x(k),children:e.jsx(E,{})})}}),A(g.data.id))}catch(n){D({message:`Failed to save Dataset Row: ${typeof n.response.data=="object"?n.response.data.message:n.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:g=>e.jsx(f,{style:{color:"white"},onClick:()=>x(g),children:e.jsx(E,{})})}}),h()}},U=m?e.jsxs(pe,{fullWidth:!0,maxWidth:"sm",open:m,onClose:h,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(me,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsx(he,{style:{marginRight:"10px"}}),i.type==="ADD"?`Add Item to ${B} Dataset`:`Edit Item in ${B} Dataset`]})}),e.jsxs(xe,{children:[e.jsxs(G,{sx:{p:2},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(L,{children:["Input",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(re,{size:"small",sx:{mt:1},multiline:!0,rows:4,type:"string",fullWidth:!0,onChange:n=>C(n.target.value),value:v??""},"input")]}),e.jsxs(G,{sx:{p:2},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(L,{children:["Anticipated Output",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(re,{size:"small",sx:{mt:1},multiline:!0,rows:4,type:"string",fullWidth:!0,onChange:n=>S(n.target.value),value:a??""},"output")]})]}),e.jsxs(ge,{children:[e.jsx(f,{onClick:()=>h(),children:i.cancelButtonName}),e.jsx(q,{permissionId:"datasets:create,datasets:update",disabled:!v||!a,variant:"contained",onClick:()=>P==="ADD"?d():I(),children:i.confirmButtonName})]}),e.jsx(Z,{})]}):null;return De.createPortal(U,_)};je.propTypes={show:N.bool,dialogProps:N.object,onCancel:N.func,onConfirm:N.func};const ft=`Only the first 2 columns will be considered:
----------------------------
| Input      | Output      |
----------------------------
| test input | test output |
----------------------------
`,fe=({show:m,dialogProps:i,onCancel:h,onConfirm:A})=>{const _=document.getElementById("portal"),l=Q();Y();const D=(...d)=>l(J(...d)),x=(...d)=>l(K(...d)),[M,w]=s.useState(""),[B,y]=s.useState(""),[v,C]=s.useState(!1),[a,S]=s.useState(),[P,b]=s.useState("ADD");s.useEffect(()=>(w(i.data.datasetId),y(i.data.datasetName),b("ADD"),()=>{b("ADD"),w(""),y(""),C(!1),S()}),[i]),s.useEffect(()=>(l(m?{type:ue}:{type:W}),()=>l({type:W})),[m,l]);const c=async()=>{try{const d={datasetId:M,firstRowHeaders:v,csvFile:a},I=await F.createDatasetRow(d);I.data&&(D({message:"New Row added for the given Dataset",options:{key:new Date().getTime()+Math.random(),variant:"success",action:U=>e.jsx(f,{style:{color:"white"},onClick:()=>x(U),children:e.jsx(E,{})})}}),A(I.data.id))}catch(d){D({message:`Failed to add new row in the Dataset: ${typeof d.response.data=="object"?d.response.data.message:d.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:I=>e.jsx(f,{style:{color:"white"},onClick:()=>x(I),children:e.jsx(E,{})})}}),h()}},j=m?e.jsxs(pe,{fullWidth:!0,maxWidth:"sm",open:m,onClose:h,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(me,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsx("div",{style:{width:50,height:50,marginRight:10,borderRadius:"50%",backgroundColor:"white"},children:e.jsx(he,{style:{width:"100%",height:"100%",padding:7,borderRadius:"50%",objectFit:"contain"}})}),"Upload Items to ["+B+"] Dataset"]})}),e.jsx(xe,{children:e.jsxs(G,{sx:{p:2},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(L,{children:["Upload CSV",e.jsx(ct,{style:{mb:1,mt:2},title:`<pre>${ft}</pre>`})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(it,{disabled:!1,fileType:".csv",onChange:d=>S(d),value:a??"Choose a file to upload"}),e.jsx(rt,{value:v,onChange:C,label:"Treat First Row as headers in the upload file?"})]})}),e.jsxs(ge,{children:[e.jsx(f,{onClick:()=>h(),children:i.cancelButtonName}),e.jsx(qe,{disabled:!a,variant:"contained",onClick:()=>P==="ADD"?c():saveDatasetRow(),children:i.confirmButtonName})]}),e.jsx(Z,{})]}):null;return De.createPortal(j,_)};fe.propTypes={show:N.bool,dialogProps:N.object,onCancel:N.func,onConfirm:N.func};var ee={},wt=We;Object.defineProperty(ee,"__esModule",{value:!0});var we=ee.default=void 0,yt=wt(Ge()),vt=e,St=(0,yt.default)((0,vt.jsx)("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"DragIndicator");we=ee.default=St;const Ht=()=>{var ne;const m=Le(),i=He(t=>t.customization),h=Q();Y();const{error:A}=Xe(),[_,l]=s.useState(!1),[D,x]=s.useState(!1),[M,w]=s.useState({}),[B,y]=s.useState(!1),[v,C]=s.useState({}),[a,S]=s.useState([]),[P,b]=s.useState(!0),[c,j]=s.useState([]),d=(...t)=>h(J(...t)),I=(...t)=>h(K(...t)),{confirm:U}=nt(),n=ie(F.getDataset),g=ie(F.reorderDatasetRow),k=document.location.pathname.toString().split("/"),O=k[k.length-1]==="dataset_rows"?"":k[k.length-1],{hasPermission:ye}=Qe(),ve=s.useRef(),te=s.useRef(),[Se,R]=s.useState(!1),[be,Ie]=s.useState(-1),[Ce,ae]=s.useState(-1),[$,ke]=s.useState(1),[z,Re]=s.useState(mt),[Te,Ee]=s.useState(0),Ne=(t,r)=>{ke(t),Re(r),H(t,r)},H=(t,r)=>{b(!0);const o={page:t||$,limit:r||z};n.request(O,o)},Ae=(t,r)=>{ve.current=r,Ie(r),ae(-1)},Be=(t,r)=>{ae(r),te.current=r},Me=(t,r)=>{te.current=r;const o={...a};o.rows.splice(Ce,0,a.rows.splice(be,1)[0]),S({...o}),t.preventDefault();const u=[];a.rows.map(($e,ze)=>{u.push({id:$e.id,sequenceNo:ze})}),g.request({datasetId:O,rows:u})},Pe=t=>{if(t.target.checked){const r=((a==null?void 0:a.rows)||[]).map(o=>o.id);j(r);return}j([])},Fe=(t,r)=>{const o=c.indexOf(r);let u=[];o===-1?u=u.concat(c,r):o===0?u=u.concat(c.slice(1)):o===c.length-1?u=u.concat(c.slice(0,-1)):o>0&&(u=u.concat(c.slice(0,o),c.slice(o+1))),j(u)},se=()=>{const t={type:"ADD",cancelButtonName:"Cancel",confirmButtonName:"Add",data:{datasetId:O,datasetName:a.name}};w(t),l(!0)},_e=()=>{const t={type:"ADD",cancelButtonName:"Cancel",confirmButtonName:"Upload",data:{datasetId:O,datasetName:a.name}};w(t),x(!0)},Ue=()=>{C({type:"EDIT",cancelButtonName:"Cancel",confirmButtonName:"Save",data:a}),y(!0)},oe=t=>{const r={type:"EDIT",cancelButtonName:"Cancel",confirmButtonName:"Save",data:{datasetName:a.name,...t}};w(r),l(!0)},Oe=async()=>{const t={title:"Delete",description:`Delete ${c.length} dataset items?`,confirmButtonName:"Delete",cancelButtonName:"Cancel"};if(await U(t)){try{(await F.deleteDatasetItems(c)).data&&(d({message:"Dataset Items deleted",options:{key:new Date().getTime()+Math.random(),variant:"success",action:u=>e.jsx(f,{style:{color:"white"},onClick:()=>I(u),children:e.jsx(E,{})})}}),V())}catch(o){d({message:`Failed to delete dataset items: ${typeof o.response.data=="object"?o.response.data.message:o.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:u=>e.jsx(f,{style:{color:"white"},onClick:()=>I(u),children:e.jsx(E,{})})}})}j([])}},V=()=>{l(!1),x(!1),y(!1),H($,z)};return s.useEffect(()=>{H($,z)},[]),s.useEffect(()=>{if(n.data){const t=n.data;S(t),Ee(t.total)}},[n.data]),s.useEffect(()=>{b(n.loading)},[n.loading]),e.jsxs(e.Fragment,{children:[e.jsx(Ye,{children:A?e.jsx(dt,{error:A}):e.jsxs(le,{flexDirection:"column",sx:{gap:3},children:[e.jsxs(ut,{isBackButton:!0,isEditButton:ye("datasets:create,datasets:update"),onEdit:Ue,onBack:()=>window.history.back(),search:!1,title:`Dataset : ${(a==null?void 0:a.name)||""}`,description:a==null?void 0:a.description,children:[e.jsx(q,{permissionId:"datasets:create,datasets:update",variant:"outlined",color:"secondary",sx:{borderRadius:2,height:"100%"},onClick:_e,startIcon:e.jsx(lt,{}),children:"Upload CSV"}),e.jsx(q,{permissionId:"datasets:create,datasets:update",variant:"contained",sx:{borderRadius:2,height:"100%"},onClick:se,startIcon:e.jsx(de,{}),children:"New Item"})]}),c.length>0&&e.jsxs(Je,{permissionId:"datasets:delete",sx:{mt:1,mb:2,width:"max-content"},variant:"outlined",onClick:Oe,color:"error",startIcon:e.jsx(gt,{}),children:["Delete ",c.length," ",c.length===1?"item":"items"]}),!P&&((ne=a==null?void 0:a.rows)==null?void 0:ne.length)<=0?e.jsxs(le,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[e.jsx(G,{sx:{p:2,height:"auto"},children:e.jsx("img",{style:{objectFit:"cover",height:"20vh",width:"auto"},src:xt,alt:"empty_datasetSVG"})}),e.jsx("div",{children:"No Dataset Items Yet"}),e.jsx(q,{permissionId:"datasets:create,datasets:update",variant:"contained",sx:{borderRadius:2,height:"100%",mt:2,color:"white"},startIcon:e.jsx(de,{}),onClick:se,children:"New Item"})]}):e.jsxs(Ke.Fragment,{children:[e.jsx(Ze,{sx:{border:1,borderColor:m.palette.grey[900]+25,borderRadius:2},component:et,children:e.jsxs(tt,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(at,{sx:{backgroundColor:i.isDarkMode?m.palette.common.black:m.palette.grey[100],height:56},children:e.jsxs(st,{children:[e.jsx(p,{padding:"checkbox",children:e.jsx(ce,{color:"primary",checked:c.length===((a==null?void 0:a.rows)||[]).length,onChange:Pe,inputProps:{"aria-label":"select all"}})}),e.jsx(p,{children:"Input"}),e.jsx(p,{children:"Expected Output"}),e.jsx(p,{style:{width:"1%"},children:e.jsx(jt,{})})]})}),e.jsx(ot,{children:P?e.jsxs(e.Fragment,{children:[e.jsxs(X,{children:[e.jsx(p,{children:e.jsx(T,{variant:"text"})}),e.jsx(p,{children:e.jsx(T,{variant:"text"})}),e.jsx(p,{children:e.jsx(T,{variant:"text"})}),e.jsx(p,{children:e.jsx(T,{variant:"text"})})]}),e.jsxs(X,{children:[e.jsx(p,{children:e.jsx(T,{variant:"text"})}),e.jsx(p,{children:e.jsx(T,{variant:"text"})}),e.jsx(p,{children:e.jsx(T,{variant:"text"})}),e.jsx(p,{children:e.jsx(T,{variant:"text"})})]})]}):e.jsx(e.Fragment,{children:((a==null?void 0:a.rows)||[]).map((t,r)=>e.jsxs(X,{draggable:Se,onDragStart:o=>Ae(o,r),onDragOver:o=>o.preventDefault(),onDragEnter:o=>Be(o,r),onDragEnd:o=>Me(o,r),hover:!0,sx:{cursor:"pointer","&:last-child td, &:last-child th":{border:0}},children:[e.jsx(p,{padding:"checkbox",onMouseDown:()=>R(!1),onMouseUp:()=>R(!0),children:e.jsx(ce,{color:"primary",checked:c.indexOf(t.id)!==-1,onChange:o=>Fe(o,t.id),inputProps:{"aria-labelledby":t.id}})}),e.jsx(p,{onClick:()=>oe(t),onMouseDown:()=>R(!1),onMouseUp:()=>R(!0),children:t.input}),e.jsx(p,{onClick:()=>oe(t),onMouseDown:()=>R(!1),onMouseUp:()=>R(!0),children:t.output}),e.jsx(p,{style:{width:"1%"},children:e.jsx(we,{onMouseDown:()=>R(!0),onMouseUp:()=>R(!1)})})]},r))})})]})}),e.jsx(L,{sx:{color:m.palette.grey[600],marginTop:-2},variant:"subtitle2",children:e.jsx("i",{children:"Use the drag icon at (extreme right) to reorder the dataset items"})}),e.jsx(ht,{currentPage:$,limit:z,total:Te,onChange:Ne})]})]})}),e.jsx(je,{show:_,dialogProps:M,onCancel:()=>l(!1),onConfirm:V}),D&&e.jsx(fe,{show:D,dialogProps:M,onCancel:()=>x(!1),onConfirm:V}),B&&e.jsx(pt,{show:B,dialogProps:v,onCancel:()=>y(!1),onConfirm:V}),e.jsx(Z,{})]})};export{Ht as default};
