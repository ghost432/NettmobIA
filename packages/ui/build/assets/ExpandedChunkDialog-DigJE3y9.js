import{f as K,s as W,r as i,v as F,H as B,j as e,D as X,m as Q,o as U,a0 as L,q as Y,ac as Z,h as $,i as P,n as ee,w as te,P as r}from"./index-B5bgjFPS.js";import{R as M}from"./main-Dw2W3SKo.js";import{C as O}from"./CodeEditor-BbQJOBPh.js";import{I as ae}from"./IconSearch-4bUU90FL.js";import{I as se}from"./IconTrash-CekgWF9B.js";import{I as ne}from"./IconLanguage-BXvwKb3u.js";const oe=({show:c,dialogProps:s,onCancel:g,onChunkEdit:_,onDeleteChunk:V,isReadOnly:p})=>{var j;const G=document.getElementById("portal"),d=K(t=>t.customization),m=W(),[a,C]=i.useState(),[x,b]=i.useState(),[n,f]=i.useState(!1),[h,u]=i.useState(""),[y,l]=i.useState({}),J=t=>{const o=t.src;Array.isArray(o)||typeof o=="object"?navigator.clipboard.writeText(JSON.stringify(o,null,"  ")):navigator.clipboard.writeText(o)},R=()=>{u(a==null?void 0:a.pageContent),l(a!=null&&a.metadata?JSON.parse(a==null?void 0:a.metadata):{}),f(!1)},q=()=>{_(h,y,a)};i.useEffect(()=>{var t,o,S,k,D,v,E,I,T,A,N,w,z;return s.data&&(C((t=s.data)==null?void 0:t.selectedChunk),u((S=(o=s.data)==null?void 0:o.selectedChunk)==null?void 0:S.pageContent),b(s==null?void 0:s.data.selectedChunkNumber),(D=(k=s.data)==null?void 0:k.selectedChunk)!=null&&D.metadata&&(typeof((E=(v=s.data)==null?void 0:v.selectedChunk)==null?void 0:E.metadata)=="string"?l(JSON.parse((T=(I=s.data)==null?void 0:I.selectedChunk)==null?void 0:T.metadata)):typeof((N=(A=s.data)==null?void 0:A.selectedChunk)==null?void 0:N.metadata)=="object"&&l((z=(w=s.data)==null?void 0:w.selectedChunk)==null?void 0:z.metadata))),()=>{C(),b(),u(""),l({}),f(!1)}},[s]),i.useEffect(()=>(m(c?{type:F}:{type:B}),()=>m({type:B})),[c,m]);const H=c?e.jsxs(X,{fullWidth:!0,maxWidth:"md",open:c,onClose:g,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(Q,{style:{fontSize:"1rem"},id:"alert-dialog-title",children:a&&x&&e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsxs(U,{sx:{flex:1},variant:"h4",children:["#",x,". ",a.id]}),!n&&!p&&e.jsx(L,{permissionId:"documentStores:preview-process",onClick:()=>f(!0),size:"small",color:"primary",title:"Edit Chunk",sx:{ml:2},children:e.jsx(ae,{})}),n&&!p&&e.jsx(Y,{onClick:()=>R(),color:"primary",title:"Cancel",sx:{ml:2},children:"Cancel"}),n&&!p&&e.jsx(Z,{permissionId:"documentStores:preview-process",onClick:()=>q(),color:"primary",title:"Save",variant:"contained",sx:{ml:2,mr:1},children:"Save"}),!n&&!p&&e.jsx(L,{permissionId:"documentStores:delete-loader",onClick:()=>V(a),size:"small",color:"error",title:"Delete Chunk",sx:{ml:1},children:e.jsx(se,{})}),e.jsx($,{onClick:g,size:"small",color:"inherit",title:"Close",sx:{ml:1},children:e.jsx(P,{})})]})}),e.jsx(ee,{children:a&&x&&e.jsxs("div",{children:[e.jsxs("div",{style:{paddingLeft:"10px",paddingRight:"10px",paddingTop:"5px",paddingBottom:"5px",fontSize:"15px",width:"max-content",borderRadius:"25px",boxShadow:d.isDarkMode?"0 2px 14px 0 rgb(255 255 255 / 20%)":"0 2px 14px 0 rgb(32 40 45 / 20%)",display:"flex",flexDirection:"row",alignItems:"center",marginTop:"5px",marginBottom:"10px"},children:[e.jsx(ne,{style:{marginRight:5},size:15}),(j=a==null?void 0:a.pageContent)==null?void 0:j.length," characters"]}),e.jsx("div",{style:{marginTop:"5px"}}),!n&&e.jsx(O,{disabled:!0,height:"max-content",value:h,theme:d.isDarkMode?"dark":"light",basicSetup:{lineNumbers:!1,foldGutter:!1,autocompletion:!1,highlightActiveLine:!1}}),n&&e.jsx(O,{disabled:!1,autoFocus:!0,height:"max-content",value:h,theme:d.isDarkMode?"dark":"light",basicSetup:{lineNumbers:!1,foldGutter:!1,autocompletion:!1,highlightActiveLine:!1},onValueChange:t=>u(t)}),e.jsxs("div",{onClick:t=>t.stopPropagation(),onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&t.stopPropagation()},role:"presentation",style:{marginTop:"20px",marginBottom:"15px"},children:[!n&&e.jsx(M,{theme:d.isDarkMode?"ocean":"rjv-default",src:y,style:{padding:"10px"},name:null,quotesOnKeys:!1,enableClipboard:!1,displayDataTypes:!1,collapsed:1}),n&&e.jsx(M,{theme:d.isDarkMode?"ocean":"rjv-default",src:y,style:{padding:"10px"},name:null,quotesOnKeys:!1,displayDataTypes:!1,enableClipboard:t=>J(t),onEdit:t=>{l(t.updated_src)},onAdd:()=>{},onDelete:t=>{l(t.updated_src)}})]})]})})]}):null;return te.createPortal(H,G)};oe.propTypes={show:r.bool,dialogProps:r.object,onCancel:r.func,onChunkEdit:r.func,onDeleteChunk:r.func,isReadOnly:r.bool};export{oe as E};
